# Telegram Video Downloader

Chrome extension to download videos from Telegram Web — supports both [Web K](https://web.telegram.org/k/) and [Web A](https://web.telegram.org/a/).

Chrome 扩展，用于从 Telegram 网页版下载视频 — 同时支持 [Web K](https://web.telegram.org/k/) 和 [Web A](https://web.telegram.org/a/)。

## Features / 功能

- **Inline download button** — automatically appears below videos in chat once they're loaded
- **Media viewer download** — download button in the topbar when viewing videos fullscreen
- Works with blob URLs generated by Telegram's encrypted media pipeline
- Manifest V3, no external dependencies

---

- **聊天内下载按钮** — 视频加载完成后，自动在视频下方显示下载按钮
- **全屏查看器下载** — 点开视频全屏查看时，顶部工具栏出现下载按钮
- 支持 Telegram 加密媒体管道生成的 blob URL
- Manifest V3，无外部依赖

## How it works / 工作原理

1. `MutationObserver` watches for `<video>` elements appearing in the DOM
2. Each video element is monitored for `src` attribute changes
3. When a video gets a `blob:` URL (meaning it's loaded/playing), a download button is injected below it
4. Clicking the button fetches the blob, creates a file, and triggers a save dialog via `chrome.downloads`

---

1. `MutationObserver` 监听 DOM 中新出现的 `<video>` 元素
2. 对每个 video 元素监听 `src` 属性变化
3. 当视频获得 `blob:` URL（即已加载/正在播放）时，在其下方注入下载按钮
4. 点击按钮后 fetch blob → 创建文件 → 通过 `chrome.downloads` 弹出保存对话框

## Install / 安装

1. Clone or download this repo / 克隆或下载本仓库
2. Open `chrome://extensions/` / 打开 `chrome://extensions/`
3. Enable **Developer mode** (top-right toggle) / 开启右上角 **开发者模式**
4. Click **Load unpacked** → select the project folder / 点击 **加载已解压的扩展程序** → 选择项目文件夹
5. Open [web.telegram.org](https://web.telegram.org/) and play a video — a download button will appear / 打开 Telegram 网页版播放视频，下载按钮会自动出现

## Usage / 使用

- **In chat / 聊天中**: Play a video → a "Download" button appears below it / 播放视频 → 下方出现 Download 按钮
- **In media viewer / 全屏查看**: Click a video to open fullscreen → download button in the top-right toolbar / 点击视频全屏查看 → 右上方工具栏出现下载按钮

## Project Structure / 项目结构

```
├── manifest.json    # Manifest V3 config / 扩展配置
├── content.js       # DOM observer + button injection + download logic / DOM 监听 + 按钮注入 + 下载逻辑
├── background.js    # Service worker for chrome.downloads API / 后台服务处理下载
└── icons/           # Extension icons / 扩展图标
```

## License / 许可

MIT
